<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Qu·∫£n l√Ω T·ªìn Kho</title>
<!-- G·ªçi config.js t·ª´ th∆∞ m·ª•c cha -->
  <script src="../js/config.js"></script>
  <script>document.write(`<base href="${BASE_URL}">`);</script>
<style>
body { font-family: Arial,sans-serif; background:#1b1b1b; color:#eee; padding:20px; }
h2 { color:#ffcc00; margin-bottom:20px; }
table { width:100%; border-collapse:collapse; margin-top:20px; }
th,td { padding:10px; border:1px solid #333; text-align:center; }
th { background:#2a2a2a; color:#ffcc00; }
tr:nth-child(even){background:#333;}
tr:nth-child(odd){background:#222;}
input, select { padding:5px; border-radius:5px; border:1px solid #555; background:#333; color:#fff; margin-right:10px; }
button { padding:5px 10px; border:none; border-radius:5px; cursor:pointer; background:#ffcc00; color:#111; }
.alert { color:#ff4444; font-weight:bold; }

/* N√∫t trang ch·ªß cu·ªëi trang */
.btn-home-container { text-align:center; margin-top:30px; }
.btn-home { background:#ffcc00; color:#111; padding:10px 20px; border-radius:8px; text-decoration:none; font-weight:bold; }
</style>
</head>
<body>

<h2>Qu·∫£n l√Ω T·ªìn Kho</h2>

<!-- Tra c·ª©u t·ªìn -->
<div>
<label>S·∫£n ph·∫©m:</label>
<select id="productSelect"></select>

<label>Lo·∫°i:</label>
<select id="categorySelect">
  <option value="">T·∫•t c·∫£</option>
  <option value="B√°nh kem">B√°nh kem</option>
  <option value="B√°nh m√¨">B√°nh m√¨</option>
  <option value="B√°nh ng·ªçt">B√°nh ng·ªçt</option>
</select>

<label>T·ª´ ng√†y:</label>
<input type="date" id="startDate">
<label>ƒê·∫øn ng√†y:</label>
<input type="date" id="endDate">
<button onclick="filterStock()">Tra c·ª©u</button>
</div>

<table>
<thead>
<tr>
<th>STT</th><th>S·∫£n ph·∫©m</th><th>Lo·∫°i</th><th>Stock hi·ªán t·∫°i</th><th>Nh·∫≠p</th><th>Xu·∫•t</th><th>Tr·∫°ng th√°i</th>
</tr>
</thead>
<tbody id="stockTable"></tbody>
</table>

<!-- N√∫t trang ch·ªß -->
<div class="btn-home-container">
  <a href="index.html" class="btn-home">üè† Quay v·ªÅ Trang ch·ªß</a>
</div>

<script>
// D·ªØ li·ªáu m·∫∑c ƒë·ªãnh (c√≥ v√†i s·∫£n ph·∫©m stock <= 10)
let defaultProducts = [
  {name:"B√°nh Kem D√¢u",type:"B√°nh kem",stock:5},
  {name:"B√°nh M√¨ Ph√°p",type:"B√°nh m√¨",stock:200},
  {name:"B√°nh Ng·ªçt Socola",type:"B√°nh ng·ªçt",stock:8},
  {name:"B√°nh Kem Matcha",type:"B√°nh kem",stock:40},
  {name:"B√°nh Su Kem",type:"B√°nh ng·ªçt",stock:10}
];

// Lu√¥n d√πng defaultProducts (b·ªè qua localStorage)
let products = defaultProducts;

// L∆∞u l·∫°i v√†o localStorage (cho sau n√†y)
localStorage.setItem("products", JSON.stringify(products));

// ƒêi·ªÅn select s·∫£n ph·∫©m
const productSelect = document.getElementById("productSelect");
productSelect.innerHTML = `<option value="">T·∫•t c·∫£</option>` + products.map(p=>`<option value="${p.name}">${p.name}</option>`).join('');

// Render b·∫£ng stock
function renderStock(filteredProducts){
  const tbody = document.getElementById("stockTable");
  tbody.innerHTML = filteredProducts.map((p,i)=>{
    let totalImport = 0;
    let totalExport = 0;
    let status = p.stock<=20 ? "‚ö†Ô∏è S·∫Øp h·∫øt h√†ng" : "OK";

    return `<tr>
      <td>${i+1}</td>
      <td>${p.name}</td>
      <td>${p.type}</td>
      <td>${p.stock}</td>
      <td>${totalImport}</td>
      <td>${totalExport}</td>
      <td class="${p.stock<=20?'alert':''}">${status}</td>
    </tr>`;
  }).join('');
}

// L·ªçc theo s·∫£n ph·∫©m v√† lo·∫°i
function filterStock(){
  let prod = productSelect.value;
  let cat = document.getElementById("categorySelect").value;

  let filtered = products.filter(p=>{
    return (!prod || p.name===prod) && (!cat || p.type===cat);
  });

  renderStock(filtered);
}

// Render to√†n b·ªô l√∫c ƒë·∫ßu
renderStock(products);
</script>
</body>
</html>
